SELECT
    payment_type,
    VendorID,
    passenger_count,
    PULocationID,
    DOLocationID,
    AVG(total_amount) AS avg_total_amount
FROM yellow_trips
WHERE trip_distance > 5
GROUP BY payment_type, VendorID, passenger_count, PULocationID, DOLocationID